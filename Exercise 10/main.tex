% Template for solutions write-ups, STAT 460/560
% Some basic notation is defined in 'macros/basic-math-macros'

\documentclass{article}
\input{macros/solutions-template}  % DO NOT CHANGE
\input{macros/typesetting-macros}  % DO NOT CHANGE
\input{macros/basic-math-macros} 
\graphicspath{{./figures/}}


\DeclareMathOperator{\KL}{\text{KL}}


\begin{document}



% FILL IN:
%  - YOUR NAME, YOUR EMAIL (self-explanatory)
%  - The assignment number goes in ##
\problemset{Junsong Tang}{junsong.tang@stat.ubc.ca}{Exercise 10}



% WRITE YOUR SOLUTION TO THE FIRST QUESTION
\qsol{Forward KL optimization}
\begin{enumerate}
\item 
\begin{proof}
\begin{align*}
& \nabla_{\phi}\KL(\pi \parallel q_{\phi}) = \nabla_{\phi} \int\pi(x) \log \frac{\pi(x)}{q_{\phi}(x)} dx = -\nabla_{\phi} \int \pi(x) \log q_{\phi}(x) dx\\
& = -\nabla_{\phi} \int \pi(x) \Big(-\frac12 (x-\phi)^2\Big) dx = -\int \pi(x) \nabla_{\phi}\Big(-\frac12 (x-\phi)^2\Big) dx\\
& = -\int \pi(x) (x - \phi) dx = \phi - \E_{\pi} X
\end{align*}

\end{proof}
\item 
Since $\pi$ is hard to sample, so $\E_{\pi} X$ is hardly known numerically, so we want to choose an optimal $q_{\phi^*}$ to approximate $\pi$. But by part (1), $\phi^* = \E_{\pi} X$ is the minimizer of KL divergence, and $\E_{\pi} X$ can be approximated by $\E_{q_{\phi^*}} X$
\end{enumerate}
    




\qsol{Asymmetric proposal}
\begin{enumerate}
\item 
xxx
\item 
xxx
\end{enumerate}
    



\qsol{Implementing HMC}
\begin{enumerate}
\item 
xxx
\item 
xxx
\end{enumerate}

 
\end{document}

